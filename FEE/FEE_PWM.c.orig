/*******************************    INCLUDES   ********************************/

#include "FEE_PWM.h"
	
/***************************    GLOBAL VARIABLES   ****************************/

extern struct FEE_RTOS_struct_def	FEE_RTOS_struct;
extern	ADC_HandleTypeDef hadc1;
extern	DMA_HandleTypeDef hdma_adc1;

extern	I2C_HandleTypeDef hi2c1;
extern	I2C_HandleTypeDef hi2c2;

extern	SPI_HandleTypeDef hspi1;

extern	TIM_HandleTypeDef htim2;
extern	TIM_HandleTypeDef htim3;
extern	TIM_HandleTypeDef htim4;

extern	UART_HandleTypeDef huart4;
extern	UART_HandleTypeDef huart5;
extern	UART_HandleTypeDef huart7;
extern	UART_HandleTypeDef huart8;
extern	UART_HandleTypeDef huart1;
extern	UART_HandleTypeDef huart2;
extern	UART_HandleTypeDef huart3;
extern	UART_HandleTypeDef huart6;
extern	DMA_HandleTypeDef hdma_uart4_rx;
extern	DMA_HandleTypeDef hdma_uart5_rx;
extern	DMA_HandleTypeDef hdma_uart7_rx;
extern	DMA_HandleTypeDef hdma_uart8_rx;
extern	DMA_HandleTypeDef hdma_usart1_rx;
extern	DMA_HandleTypeDef hdma_usart2_rx;
extern	DMA_HandleTypeDef hdma_usart3_rx;
extern	DMA_HandleTypeDef hdma_usart6_rx;

/***************************       FUNCTIONS       ****************************/
void FEE_PWM_Innit(void)
{
    HAL_TIM_PWM_Start(&htim2, TIM_CHANNEL_1);
    HAL_TIM_PWM_Start(&htim2, TIM_CHANNEL_2);
    HAL_TIM_PWM_Start(&htim2, TIM_CHANNEL_3);
    HAL_TIM_PWM_Start(&htim2, TIM_CHANNEL_4);
    DC_PWM1(0,0);
    DC_PWM2(0,0);
    DC_PWM3(0,0);
    DC_PWM4(0,0);
}

void DC_PWM1(uint8_t chieu, uint8_t toc_do)
{
    HAL_GPIO_WritePin(GPIOC,GPIO_PIN_2,chieu); //DIR1
    __HAL_TIM_SetCompare(&htim2,TIM_CHANNEL_1, toc_do*4);
}

void DC_PWM2(uint8_t chieu, uint8_t toc_do)
{
    HAL_GPIO_WritePin(GPIOC,GPIO_PIN_3,chieu); //DIR2
    __HAL_TIM_SetCompare(&htim2,TIM_CHANNEL_2, toc_do*4);
}

void DC_PWM3(uint8_t chieu, uint8_t toc_do)
{
    HAL_GPIO_WritePin(GPIOC,GPIO_PIN_9,chieu); //DIR3
    __HAL_TIM_SetCompare(&htim2,TIM_CHANNEL_3, toc_do*4);
}

void DC_PWM4(uint8_t chieu, uint8_t toc_do)
{
    HAL_GPIO_WritePin(GPIOA,GPIO_PIN_4,chieu); //DIR4
    __HAL_TIM_SetCompare(&htim2,TIM_CHANNEL_4, toc_do*4);
}